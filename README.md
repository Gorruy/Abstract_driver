# Abstract_driver
Абстрактный драйвер представляет из себя загружаемый модуль ядра, реализующий интерфейс в виде системных вызовов read, write, lseek, mmap и sysfs для виртуальной памяти из пространства ядра, для каждого устройства выделяется 4096 байт памяти (страница), помимо системных вызовов, работающих стандартным способом, доступ к памяти устройства осуществляется через атрибуты sysfs: abs_value и abs_address, в начале работы оба значения проинициализированы нулями, для смены адреса записи в память необходимо записать значение меньше 4096 в abs_address 
## Build
следующая команда в корне проекта создаст в папке src два объектных файла: abs.ko и abs_test_devices.ko
```sh
cd src & make
```
## Install

В папке src необходимо ввести следующие команды в любом порядке:
```sh
sudo insmod abs.ko
sudo insmod abs_test_devices.ko
```

Данные команды загрузят в ядро модуль драйвера и 4 тестовых устройства

## Usage
С помощью следующих команд помжно проверит работу sysfs
```sh
sudo echo -n a | sudo tee -a /sys/devices/platform/abs_platform_device.0/abs_value
sudo cat /sys/devices/platform/abs_platform_device.0/abs_value
```
Первая запишет в нулевой адрес латинскую букву a (ее ascii код), вторая ее прочитает, для того чтобы поменять адрес необходимо так же как и в первой команде записать его в атрибут abs_address

Проверить системные вызовы можно с помощью файла test.c в папке tests:
```sh
make & sudo ./test
```
Данная программа проверяет работоспособность devfs записывая в файл, читая из него, меняя смещение в файле и отображая память
